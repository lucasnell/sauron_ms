
\renewcommand{\thefigure}{A\arabic{figure}}
\renewcommand{\theequation}{A\arabic{equation}}
\renewcommand{\thetable}{A\arabic{table}}
\setcounter{equation}{0}
\setcounter{figure}{0}
\setcounter{table}{0}


\section*{Appendix A: Analytical solutions, non-negative investments, and stochasticity}



\subsection*{Analytical solutions}

Below are the full equations for fitness and investments at time $t+1$, with
the parameter for scaled community size ($\Omega_i$) defined as the 
total community abundance accounting for the effect of species' investments 
on competition experienced by species $i$.
These equations are used for the analytical solutions in this section.

\begin{equation}
\label{eq:analytical-equations}
\begin{split}
    F_{i,t+1} &= \exp\left\{
        r_0 - f \, \left( x_{i,t}^2 + 2 \eta \, x_{i,t} \, p_{i,t} + p_{i,t}^2 \right)
        - \alpha_0 N_{i,t} - \alpha_0 \, \text{e}^{-x_{i,t}^2 - p_{i,t}^2} \, \Omega_{i,t}
        \right\} \\
    x_{i,t+1} &= x_{i,t} + 2 \, \sigma_A^2 \left[
            \alpha_0 \, \text{e}^{-x_{i,t}^2 - p_{i,t}^2} \, x_{i,t} \,
            \Omega_{i,t}
            - f \left( x_{i,t} + \eta \, p_{i,t} \right) 
        \right]\\
    p_{i,t+1} &= p_{i,t} + 2 \, \sigma_A^2 \left[
            \alpha_0 \, \text{e}^{-x_{i,t}^2 - p_{i,t}^2} \, p_{i,t} \,
            \Omega_{i,t}
            - f \left( p_{i,t} + \eta \, x_{i,t} \right) 
        \right] \\
    \Omega_{i,t} &\equiv \sum_{j \ne i}^{n}{ N_{j,t} \, \text{e}^{ 
                -d_x \, x_{j,t}^2 - d_p \, p_{j,t}^2 } }
    \text{.}
\end{split}
\end{equation}

For a 1-species community, unless $\eta = -1$,

\begin{equation}
\label{eq:analytical-1spp-solns}
\begin{split}
    \hat{x}_{i} = \hat{p}_{i} &= 0 \\
    \hat{N}_i &= \frac{r_0}{\alpha_0}
    \text{.}
\end{split}
\end{equation}

In a multispecies community at equilibrium, 
if $\hat{x}_{i} \ne 0 \And \hat{p}_{i} \ne 0$,

\begin{equation}
\label{eq:analytical-sub-solns}
\begin{split}
    \hat{x}_i = \hat{p}_i &= \sqrt{\frac{1}{2} \log \left( 
        \frac{\alpha_0 \, \hat{\Omega}_i}{f (1 + \eta)}  \right)} \\
    \hat{N}_i &= \frac{1}{\alpha_0} \left(
        r_0 - f (1 + \eta) \left[
            \log\left( \frac{\alpha_0 \, \hat{\Omega}_i }{f (1 + \eta)}
            \right) + 1 
        \right]
    \right)
    \text{.}
\end{split}
\end{equation}

If instead $\hat{x}_i \ne 0 \And \hat{p}_i = 0$ or
$\hat{x}_i = 0 \And \hat{p}_i \ne 0$, then 

\begin{equation}
\label{eq:analytical-super-solns}
\begin{split}
    \hat{x}_i \textrm{ or } \hat{p}_i &= \sqrt{\log \left( 
            \frac{\alpha_0 \, \hat{\Omega}_i}{f} 
        \right)} \\
    \hat{N}_i &= \frac{1}{\alpha_0} \left(
        r_0 - f \left[
            \log\left( \frac{\alpha_0 \, \hat{\Omega}_i }{f}
            \right) + 1 
        \right]
    \right)
    \text{.}
\end{split}
\end{equation}




\subsection*{Keeping investments non-negative}

To keep investments $\ge 0$, we used the ramp function, $R(z) = \max(0,z)$. 
Its derivative is the Heaviside step function:

\begin{equation*}
    H(z) = \begin{cases}
        0 & \text{if}\ z \le 0 \\
        1 & \text{if}\ z > 0
        \end{cases}
    \text{.}
\end{equation*}

% Also see https://see.stanford.edu/materials/lsoftaee261/book-fall-07.pdf
% and https://mathworld.wolfram.com/RampFunction.html

Thus, all investment derivatives of the form $\partial x / \partial z$
and $\partial p / \partial z$
are changed to $H(x(z)) \: \partial x / \partial z$ and
$H(p(z)) \: \partial p / \partial z$, respectively, to
account for investments being non-negative.



\subsection*{Effects of stochasticity on investment evolution}

When there is non-adaptive stochasticity in investment evolution,
the second order Taylor series approximation for the expected
value of $x_{t+1}$ is

\begin{equation}
\label{eq:taylor-expansion-final}
\begin{split}
    \text{E}(x_{t+1}) & \approx
        x_{t} + 2 \; \sigma_A^2 \; \Bigg\{ \\
            & \alpha_0 \: \Omega \: 
            x_{t} \; \text{e}^{-x_{t}^2 - p_{t}^2} 
            \bigg[ 
                1 + \sigma^2_{x} \left( \frac{1}{2} - 4 \; x_{t}^2 \right) \\
                & \hspace*{6em} - 2 \; \sigma^2_{p} \, p_{t}^2 \left( 1 - p_{t}^2 \right)
            \bigg] \\
            & - f \bigg[
                x_{t} + \eta \; p_{t} + \frac{1}{2} \left(
                    \sigma^2_{x} \, x_{t} + \sigma^2_{p} \, \eta \; p_{t}
                \right)
            \bigg]
        \Bigg\}
\text{,}
\end{split}
\end{equation}

\noindent where we drop the index for species to reduce clutter.


